@model ModelLayer.Models.ReceiveOrderOnCall

@{
    ViewBag.Title = "Create [ Receive Order On Call ]";
    //Layout = null;
    Layout = "~/Views/Shared/_Layout_franchise2.cshtml";
}
<style>
    textarea {
        width: 80%;
        height: 40px;
    }
</style>
<div class="row">
    <div class="span12">
        <div class="widget">
            <div class="widget-header">
                <i class="icon-list-alt"></i>
                <h3> Create [ Receive Order On Call ]</h3>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <div class="widget big-stats-container">
                    <div class="widget-content">

                        @using (Html.BeginForm())
                        {
                            @Html.AntiForgeryToken()

                            <div class="form-horizontal">
                                @Html.ValidationSummary(true)

                                <div class="control-group">
                                    <span class="control-label">Customer Name</span>
                                    <div class="controls">
                                        @Html.TextBoxFor(model => model.Name, new { id = "Name" })
                                        @Html.ValidationMessageFor(model => model.Name)
                                    </div>
                                </div>

                                <div class="control-group">
                                    <span class="control-label">Mobile</span>
                                    <div class="controls">
                                        @Html.TextBoxFor(model => model.PrimaryMobile, new { id = "PrimaryMobile" })
                                        @Html.ValidationMessageFor(model => model.PrimaryMobile)
                                    </div>
                                </div>

                                <div class="control-group">
                                    <span class="control-label">Secondary Mobile</span>
                                    <div class="controls">
                                        @Html.EditorFor(model => model.SecondaryMobile, new { id = "SecondaryMobile" })
                                        @Html.ValidationMessageFor(model => model.SecondaryMobile)
                                    </div>
                                </div>

                                <div class="control-group">
                                    <span class="control-label">Email</span>
                                    <div class="controls">
                                        @Html.EditorFor(model => model.Email, new { id = "Email" })
                                        @Html.ValidationMessageFor(model => model.Email)
                                    </div>
                                </div>

                                <div class="control-group">
                                    <span class="control-label">Shipping Address</span>
                                    <div class="controls">
                                        @Html.TextAreaFor(model => model.ShippingAddress, new { id = "ShippingAddress" })
                                        @Html.ValidationMessageFor(model => model.ShippingAddress)
                                    </div>
                                </div>

                                <div class="control-group">
                                    <span class="control-label">Description</span>
                                    <div class="controls">
                                        @Html.TextAreaFor(model => model.Description)
                                        @Html.ValidationMessageFor(model => model.Description)
                                    </div>
                                </div>

                                @*<div class="control-group">
                                    <span class="control-label">Order No</span>
                                    <div class="controls">
                                        @Html.TextBox("OrderCode", null, new { @id = "OrderCode", @class = "form-control-Widout-block", @placeholder = "Enter Order Code", @onkeypress = "return isValidOrderCode(event)" })
                                        <img id="OrderNo_loading" src="~/Content/Images/ajax_loader.gif" style="width: 30px; height: 30px; display: none" />
                                        <div id="divOrderNoError" style="width:400px; display: none; padding:5px" class="alert-danger focused">  </div>
                                    </div>
                                </div>*@

                                <div class="control-group">
                                    <div style="float:right">
                                        <input type="submit" value="Create" class="btn btn-danger" />
                                    </div>
                                </div>
                            </div>
                        }

                        <div>
                            @Html.ActionLink("Back to List", "Index")
                        </div>
                    </div>
                </div>
                <!-- /widget-content -->
            </div>
        </div>
    </div>
</div>

@section Myscripts{
    <script type="text/javascript">

        var lOrderCode = $('#OrderCode').val()

        $('#OrderCode').bind('input propertychange', function () {
            var lOrderCode = $('#OrderCode').val()
            $('#divOrderNoError').hide();

            if (lOrderCode.length == 15) {
                $('#OrderNo_loading').show();
                $.ajax({
                    url: '@Url.Action("IsValidOrder", "ReceiveOrderOnCall")?OrderCode=' + lOrderCode,
                    type: "GET",
                    success: function (result) {
                        //alert('success');
                        if (result == "true") {
                            $('#OrderNo_loading').hide();
                            $('#divOrderNoError').hide();
                        }
                        else {
                            $('#OrderNo_loading').hide();
                            $('#divOrderNoError').show();
                            $('#divOrderNoError').html('Order Code [' + lOrderCode + '] dose not exist');
                            $('#OrderCode').val('');
                        }
                    },
                    error: function (result) {
                        //alert('error');
                        //alert('Pincode : ' + lPincode + ' Dose Not Exist, please Contact to ADMIN');
                        $('#OrderNo_loading').hide();
                        $('#divOrderNoError').show();
                        $('#divOrderNoError').html('Order Code [' + lOrderCode + '] dose not exist');
                        $('#OrderCode').val('');
                    }
                });
            }
        });






        //-----------------------------------------------------------To Get Details of Customer by Mobile --//

        var lPrimaryMobile = $('#PrimaryMobile').val()

        $('#PrimaryMobile').bind('input propertychange', function () {
            var lPrimaryMobile = $('#PrimaryMobile').val()
            if (lPrimaryMobile.length == 10) {
                $.ajax({
                    url: '@Url.Action("GetCustomerDetail", "ReceiveOrderOnCall")?Mobile=' + lPrimaryMobile,
                    type: "GET",
                    success: function (result) {
                        var resultArray = result.split(";");
                        $('#Name').val(resultArray[0]);
                        $('#SecondaryMobile').val(resultArray[1]);
                        $('#Email').val(resultArray[2]);
                        $('#ShippingAddress').html(resultArray[3]);

                    },
                    error: function (data) {
                        alert('error');
                    }
                });
            }
        });






    </script>



}


