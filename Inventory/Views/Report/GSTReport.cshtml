
<style type="text/css">
    #loading {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(255,255,255,0.8);
        z-index: 1000;
    }

    #loadingcontent {
        display: table;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
    }

    #loadingspinner {
        display: table-cell;
        vertical-align: middle;
        width: 100%;
        text-align: center;
        font-size: larger;
        padding-top: 80px;
    }
    section.right_side_main_part .row-fluid .box.span12.right_side_up_part .box-content table tbody tr td {
        padding: 10px;
    }
        section.right_side_main_part .row-fluid .box.span12.right_side_up_part .box-content table tbody tr td select {
            border-radius: 5px !important;
            margin-bottom: 0;
        }
</style>
<script src="~/Content/assets/js/Spinner.js"></script>
<link href="~/Content/PagedList.css" rel="stylesheet" />
<script>
    $(document).ready(function () {
        var WarehouseLevel = '@Session["WarehouseLevel"]';
        if (WarehouseLevel == 3 || WarehouseLevel == 2) {
            $("#WarehouseId").val('@Session["WarehouseID"]')
            $("#WarehouseId").attr("disabled", "disabled");
        }
        //
        $("#btnExport").attr("disabled", "disabled");
        var isFV = '@ViewBag.isFV';
        var page = 1;
        $("#ddlmonth").val('@ViewBag.Month');

         ///Added by Priti on 20-1-2019

        $("#ddlyear").val('@ViewBag.year');
        //end by priti



        if (isFV == "False") {
            $("#lblWarehouse").text("Select Distribution Center");
            $("#heading").text("Distribution Center GST Report");
        }
        else if (isFV == "True") {
            $("#lblWarehouse").text("Select Fullfillment Center");
            $("#heading").text("Fullfillment Center GST Report");
        }
        else {
            $("#divWarehouse").hide();
            $("#heading").text("Ezeelo GST Report");
        }
        if ('@ViewBag.IsPaged' == "1") {
            $("#WarehouseId").val('@ViewBag.WarehouseId');
            page = '@ViewBag.page';
            ShowReport();
        }
        $("#ddlmonth").change(function () {
            page = 1;
            $("#btnExport").attr("disabled", "disabled");
        });
        ///Added by Priti on 20-1-2019
        $("#ddlyear").change(function () {
            page = 1;
            $("#btnExport").attr("disabled", "disabled");
        });
        $("#WarehouseId").change(function () {
            $("#btnExport").attr("disabled", "disabled");
            page = 1;
        });
        function ShowReport() {
            var Month = $("#ddlmonth").val();
            var year = $("#ddlyear").val();   ///ADDED BY Priti
            var WarehouseId = $("#WarehouseId").val();

            if (isFV == "" || WarehouseId != "") {
                
                $("#loading").fadeIn();
                var opts = {
                    lines: 12, // The number of lines to draw
                    length: 7, // The length of each line
                    width: 4, // The line thickness
                    radius: 10, // The radius of the inner circle
                    color: '#000', // #rgb or #rrggbb
                    speed: 1, // Rounds per second
                    trail: 60, // Afterglow percentage
                    shadow: false, // Whether to render a shadow
                    hwaccel: false // Whether to use hardware acceleration
                };
                var target = document.getElementById('loading');
                var spinner = new Spinner(opts).spin(target);


                     //Added by Priti 
                if (isFV == "") {
                    $("#GstReportdiv").load("/Report/GetGSTReportList?page=" + page + "&Month=" + Month + "&year=" + year + "&WarehouseId=" + WarehouseId);
                }
                else {
                    $("#GstReportdiv").load("/Report/GetGSTReportList?page=" + page + "&isFV=" + isFV + "&Month=" + Month + "&year=" + year +  "&WarehouseId=" + WarehouseId);
                }
                   //  end by Priti
            } else {
                $("#inputGstReportdiv").html("");
                if (isFV == "False") {
                    alert("Please Select Distribution Center");
                }
                else {
                    alert("Please Select Fullfillment Center");
                }
            }
        }
        $("#btnGo").click(function () {
            ShowReport();
        });
        $("#btnExport").click(function () {
            var WarehouseId = $("#WarehouseId").val();
            if (WarehouseId == "")
            {
                WarehouseId = 0;
            }
            window.location = "/Report/ExportToExcel?ProductId=" + WarehouseId + "&flag=4";
        })

    });
</script>
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">
    var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
            window.location.href = uri + base64(format(template, ctx))
        }
    })()
</script>
<section class="right_side_main_part">
<div class="row-fluid">
        <div class="box span12 right_side_up_part">
        <div class="box-header">
            <h2>
                <i class="icon-list-alt"></i>
                <span class="break"></span>
                <span id="heading"> Output GST Report</span>
            </h2>
        </div>
        <div class="box-content">
           
                <table>
                    <tr>
                        <td>
                            <div>
                                <label> Select Month</label>
                                <select id="ddlmonth" style="text-transform:uppercase;width:130px">
                                    <option value="1">january</option>
                                    <option value="2">february</option>
                                    <option value="3">march</option>
                                    <option value="4">april</option>
                                    <option value="5">may</option>
                                    <option value="6">jun</option>
                                    <option value="7">july</option>
                                    <option value="8">augest</option>
                                    <option value="9">september</option>
                                    <option value="10">october</option>
                                    <option value="11">november</option>
                                    <option value="12">december</option>

                                </select>
                            </div>


                            @*///Added by Priti 10-1-2019*@
                            <div>
                                <label> Select year</label>
                                <select id="ddlyear" style="text-transform:uppercase;width:130px">
                                    <option value="2018">2018</option>
                                    <option value="2019">2019</option>
                                    <option value="2020">2020</option>
                                    <option value="2021">2021</option>
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024">2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                    <option value="2030">2030</option>


                                </select>
                            </div>
                            @*end by Priti*@
                        </td>
                        <td>
                            <div id="divWarehouse">
                                <label><span style="color:#b61010;font-size:20px">*</span><span id="lblWarehouse">Select Warehouse </span> </label>
                                @Html.DropDownList("WarehouseId", ((List<ModelLayer.Models.Warehouse>)ViewBag.PossibleWarehouse).Select(option => new SelectListItem
                       {
                           Text = (option == null ? "None" : option.Name),
                           Value = option.ID.ToString(),
                           Selected = (Model != null) && (option.ID == @ViewBag.SelectedWarehouse)
                       }), "-- SELECT --")
                            </div>
                        </td>
                        @*<td style="padding:15px">
                        <div>
                            <label> Search By </label>
                            <select id="ddlmonth" style="text-transform:uppercase;width:130px">
                                <option value="1">Invoice Date</option>
                                <option value="2">Invoice Code</option>
                                <option value="3">Item Name</option>
                                <option value="4">GST</option>
                                <option value="5">MRP</option>
                            </select>
                        </div>
                    </td>
                    <td style="padding:15px">
                        <div>
                            <label></label>
                            <select id="ddlmonth" style="text-transform:uppercase;width:130px">
                                <option value="1">Invoice Date</option>
                                <option value="2">Invoice Code</option>
                                <option value="3">Item Name</option>
                                <option value="4">GST</option>
                                <option value="5">MRP</option>
                            </select>
                        </div>
                    </td>*@
                        <td>
                            <input type="button" value="&nbsp;&nbsp; Go &nbsp;&nbsp;" class="btn-success btn btn-warning btn-small" id="btnGo" style="margin-top:18px;" />
                        </td>
                        <td>
                            <input type="button" onclick="tableToExcel('tblGSTReport', 'www.ezeelo.com')" value="&nbsp; Export To Excel &nbsp;" class="btn-success btn btn-warning btn-small" style="margin-top:18px;">
                        </td>
                    </tr>
                </table>
            <div id="loading">
                <div id="loadingcontent">
                    <p id="loadingspinner">
                        Loading Report....
                    </p>
                </div>
            </div>
            <center>
                <div id="GstReportdiv" style="font-size:15px !important;">

                </div>
            </center>
        </div>
    </div>
</div>
    </section>