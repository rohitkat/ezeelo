@model ModelLayer.Models.ViewModel.BBPTabularviewModel
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LeaderUsersLayout.cshtml";
}


<link href="//cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<script src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<style>
    .maintabularPageView {
        font-size: medium !important
    }

    .table .thead-dark th {
        color: #fff;
        background-color: #620000 !important;
        border-color: #FF8888;
        font-size: medium !important
    }

    .table tr {
        color: black;
    }

    .panel-title {
        color: #620000 !important;
        text-decoration: double !important;
        font-weight: bold;
    }
</style>
<script>
    $(document).ready(function () {
        $('#tablePreview').DataTable({
            "order": [[0, 'asc']]
        });
        $('#tablePreview').slideDown(100);
        $("#LevelId").change(function () {
            var SelValue = $("#LevelId option:selected").val()
            oTable = $('#tablePreview').DataTable();
            //oTable.columns(3).search(SelValue).draw();
            if (SelValue == 0) {
                oTable.columns(3).search('').draw();
            } else {
                SelValue = 'L' + SelValue;
                oTable.column(3).search('^' + SelValue + '$', true, false).draw(); //for exact searrch
            }
        });
        $("#chkSub").change(function () {
            oTable = $('#tablePreview').DataTable();
            if ($(this).prop("checked") == true) {
                oTable.column(5).search('^Yes$', true, false).draw();
            } else {
                oTable.columns(5).search('').draw();
            }
        });
        $("#PayoutDateFilterId").change(function () {
            $("#bbpTabularRpt").submit();
        });
    });
</script>
<section class="maintabularPageView">
    <div class="maintabularPageView-child">
        <div class="container">
            <span class="maintabularPageView-heading">
                <span>
                    @using (Html.BeginForm("BBPTabularView", "BBPUsersReport", null, FormMethod.Post, new { id = "bbpTabularRpt" }))
                    {
                        <span>
                            @Html.DropDownListFor(m => m.PayoutDateFilterId, Model.PayoutDateFilter, "Select Business Booster Payout Week", new { @class = "form-control valid", style = "width:auto;display:inline;margin-left:10px;" })
                        </span>

                        <span>
                            <select class="form-control valid" id="LevelId" name="LevelId" style="width:120px;display: inherit !important;margin-left:10px">
                                <option selected="selected" value="0">All Levels</option>
                                <option value="1">Level: 1</option>
                                <option value="2">Level: 2</option>
                                <option value="3">Level: 3</option>
                                <option value="4">Level: 4</option>
                                <option value="5">Level: 5</option>
                                <option value="6">Level: 6</option>
                                <option value="7">Level: 7</option>
                                <option value="8">Level: 8</option>
                                <option value="9">Level: 9</option>
                                <option value="10">Level: 10</option>
                                <option value="11">Level: 11</option>
                                <option value="12">Level: 12</option>
                                <option value="13">Level: 13</option>
                                <option value="14">Level: 14</option>
                                <option value="15">Level: 15</option>
                                <option value="16">Level: 16</option>
                            </select>
                        </span>
                        <span>
                            <input name="chkSub" type="checkbox" id="chkSub" class="form-control small" style="width:25px; height:25px; display: inherit !important;margin-left:10px;" /> <span style="font-weight:bold;"> Only Subscribers</span>
                        </span>
                    }
                </span>

        </div>


        <table id="tablePreview" style="display:none;" class="table table-striped table-hover table-responsive">
            <thead class="thead-dark">
                <tr>
                    <th style="width:50px">#</th>
                    <th>Name</th>
                    <th style="width:150px">Refferal ID</th>
                    <th style="width:50px">Level</th>
                    <th style="width:150px">Parent Name</th>
                    <th style="width:50px">Subscriber</th>
                    <th style="width:150px">Subscription Date</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.list)
                {
                    <tr>
                        <td>@item.SrNo</td>
                        <td>@item.Name</td>
                        <td>@item.RefferalID</td>
                        <td>@item.Level</td>
                        <td>@item.ParentName</td>
                        <td>@item.Booster_Purchased</td>
                        <td>@item.PurchaseDate</td>
                    </tr>
                }
            </tbody>
        </table>

    </div>
    </div>
</section>

@if (TempData["Search"] != null && TempData["Search"].ToString() == "1")
{
    <script>
        $(document).ready(function () {
            $("#chkSub").prop("checked", true);
            $("#chkSub").change();
        })
    </script>
}

@if (TempData["SearchLevel"] != null)
{
    <script>
        $(document).ready(function () {
            $("#LevelId").val('@TempData["SearchLevel"]')
            $("#LevelId").change();
        })
    </script>
}

