@model List<ModelLayer.Models.EzeeMoneyPayoutDetails>
@{
    ViewBag.Title = "ImportUserList";
    Layout = "~/Views/Shared/_LeadersLayout.cshtml";
}

<script src="~/Scripts/jquery-1.12.4.js"></script>
<script src="~/Content/js/jquery-2.1.3.min.js"></script>
<script src="~/Content/js/jquery.dataTables.min.js"></script>
<link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet" />

<script type="text/javascript">
    $(document).ready(function () {
        $('#tblData').DataTable();
        if ('@ViewBag.Msg' != '') {
            alert("@ViewBag.Msg")
        }


        $("#btnClear").click(function () {
            $(".k-upload-files.k-reset").find("li").parent().remove();
            $("#wrap").html("");
            $("#btnPayout").hide();
        })

        $("#btnPayout").click(function () {
            var RefText = $("#txtRef").val().trim();
            if (RefText == "") {
                alert("Please add refference Text");
                $("#txtRef").focus();
            }
            else {
                var r = confirm("Continue to Payout process..");
                if (r == true) {
                    $.ajax({
                        type: "POST",
                        dataType: "text",
                        url: '/BonusERP/UserwisePayout?RefText=' + RefText,
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            alert(data);
                            $("#btnClear").click();
                        },
                        error: function (xhr) {

                        }
                    });
                }
            }
        });
    });
</script>
<h4>Import User List</h4>
<p style="color:red">Note: Insert only Excel sheet with column name UserLoginId and EzeeMoney</p>
@using (Html.BeginForm("ImportUserList", "BonusERP", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
<div>
    <br />
    <input type="file" name="file" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="fileUpload" />
    &nbsp;&nbsp;
    <input type="submit" value="Show User List" class="btn btn-warning" />
    &nbsp;&nbsp;
    <input type="button" value="Clear" id="btnClear" class="btn btn-info" />
    &nbsp;&nbsp;
    <input type="button" value="Pay" id="btnPayout" class="btn btn-success" />
    <br />
    <br />
    <label>Reference Text</label>  <input type="text" id="txtRef" style="width:700px" />
    <br />
    <br />
    <div id="wrap">
        <div class="container">
            <div id="content" class="span10" style="min-height: 403px;">
                @if (Model.Count == 0)
                {
                    <script>
                        $("#btnPayout").hide();
                    </script>
                    <table class="table table-bordered table-striped table-condensed display" width="100%">
                        <thead>
                            <tr>
                                <th>UserLoginId</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone No</th>
                                <th>EzeeMoney</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="12" style="min-width:960px;max-width:960px">
                                    <label style=" color: #138afc; ">No Record Found.... </label>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                }
                else
                {
                    <script>
                        $("#btnPayout").show();
                    </script>
                    <table id="tblData" class="table table-bordered table-striped table-condensed display" width="100%">
                        <thead>
                            <tr>
                                <th>UserLoginId</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone No</th>
                                <th>EzeeMoney</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in @Model)
                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.UserLoginId)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Name)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.EmailId)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.PhoneNo)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.EzeeMoney)
                                    </td>
                                </tr>
                            }

                        </tbody>
                    </table>
                }
            </div>
        </div>
    </div>
</div>
}


