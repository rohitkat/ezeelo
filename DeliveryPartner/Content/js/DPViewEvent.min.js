$(function () { function e(e) { $.ajax({ url: e, data: {}, type: "POST", async: !1, cache: !1, success: function (e) { $("#loader_img").hide(), $("#lblAssign").html("") }, error: function (e) { return $("#loader_img").hide(), $("#lblAssign").html(""), !1 } }) } function t(e, t) { $.ajax({ url: e, data: {}, type: "POST", async: !1, cache: !1, success: function (e) { return "True" == e ? void $("#insertHere").html("") : "False" == e && "IsJobAssigned" == t ? ($("#insertHere").html("<p>No Job is assigned for this Customer Order. Please assign it.</p>").css("color", "red"), !1) : "False" == e && "IsAssignToDifferentPerson" == t ? ($("#insertHere").html("<p>Some item(s) of this Customer order is already assigned to different person for delivery. Please assign to same person for single OTP.</p>").css("color", "red"), !1) : "False" == e && "IsDifferentDateAndScheduleAssigned" == t ? ($("#insertHere").html("<p>Do not club different Date & Schedule assignment for generating single OTP. Please assign same Data & Schedule for single OTP.</p>").css("color", "red"), !1) : "False" == e && "IsTaskTypeMatach" == t ? ($("#insertHere").html("<p>Please change delivery boy 'Task Type' to 'Delivery'.</p>").css("color", "red"), !1) : void $("#loader_img").hide() }, error: function (e) { return $("#loader_img").hide(), $("#insertHere").html(""), !1 } }) } var n, s, l, r, a, i = $("[name=DeliveryStatus] option:selected"); "DELIVERED" != i.text() || "DISPATCHED_FROM_GODOWN" != i.text() || "RETURNED" != i.text() ? ($("#pnlSendSMS").hide(), $("#pnlMerchantCount").hide(), $("#pnlSendSMSPrtial").hide()) : ($("#pnlSendSMS").show(), $("#pnlMerchantCount").show(), $("#pnlSendSMSPrtial").show()), $("[name=DeliveryStatus]").change(function () { $("#insertHere").html(""); var e = $("[name=DeliveryStatus] option:selected"); if ("CANCELLED" == e.text() || "RETURNED" == e.text() || "DELIVERED" == e.text() || "DISPATCHED_FROM_GODOWN" == e.text()) if (0 == $("option:selected", $(this)).index()) $("#pnlSendSMS").hide(), $("#pnlMerchantCount").hide(), $("#pnlSendSMSPrtial").hide(); else { var t = $("#lblMerchantCount").html(), i = t.indexOf("having "); i += 7; var o = t.indexOf("Merchant(s), "); o += 13; var d = t.indexOf("Dispatched, "); d += 12; var c = t.indexOf("Delivered, "); c += 11; var h = t.indexOf("and "); h += 4, n = t.substring(i, t.indexOf(" Merchant(s)")), s = t.substring(o, t.indexOf(" Dispatched")), l = t.substring(d, t.indexOf(" Delivered")), r = t.substring(c, t.indexOf(" Returned")), a = t.substring(h, t.indexOf(" Cancelled")), 1 == parseInt(n) ? $("#pnlSendSMS").show() : $("#pnlSendSMSPrtial").show(), $("#lblSendSMSValidation").html(""), $("#pnlMerchantCount").show() } else $("#pnlSendSMS").hide(), $("#pnlMerchantCount").hide(), $("#pnlSendSMSPrtial").hide() }), $("#btnUpdateStatus").click(function (e) { $("#insertHere").html(""), 0 == $("option:selected", $("[name=DeliveryStatus]")).index() && ($("#insertHere").html("Please change 'Order Status'.").css("color", "red"), e.preventDefault()); var i = $("[name=DeliveryStatus] option:selected"); if ("DISPATCHED_FROM_GODOWN" == i.text()) { var o = $("#hidShopOrderCode").val(), d = "/DeliveryOrderDetail/IsJobAssigned?ShopOrderCode=" + o; t(d, "IsJobAssigned"); var c = $("#insertHere").html(); "" != c && e.preventDefault(); var h = $("#hidOrderCode").val(), d = "/DeliveryOrderDetail/IsAssignToDifferentPerson?OrderCode=" + h + "&ShopOrderCode=" + o; t(d, "IsAssignToDifferentPerson"); var c = $("#insertHere").html(); "" != c && e.preventDefault(); var h = $("#hidOrderCode").val(), d = "/DeliveryOrderDetail/IsDifferentDateAndScheduleAssigned?OrderCode=" + h + "&ShopOrderCode=" + o; t(d, "IsDifferentDateAndScheduleAssigned"); var c = $("#insertHere").html(); "" != c && e.preventDefault(); var h = $("#hidOrderCode").val(), d = "/DeliveryOrderDetail/IsTaskTypeMatach?OrderCode=" + h + "&ShopOrderCode=" + o; t(d, "IsTaskTypeMatach"); var c = $("#insertHere").html(); "" != c && e.preventDefault() } var p = $("input[name='IsSendEmailSMS']:checked").length, S = $("input[name='IsSendEmailSMSPartial']:checked").length; 1 != parseInt(n) || "DISPATCHED_FROM_GODOWN" != i.text() && "DELIVERED" != i.text() || 0 != parseInt(p) || 0 != parseInt(S) ? "DISPATCHED_FROM_GODOWN" == i.text() && parseInt(n) == parseInt(s) + parseInt(l) + parseInt(r) + parseInt(a) + 1 && 0 == parseInt(p) && 0 == parseInt(S) ? ($("#lblSendSMSValidation").show(), $("#lblSendSMSValidation").html("Please select the checkbox..."), e.preventDefault()) : "DELIVERED" == i.text() && parseInt(n) == parseInt(l) + parseInt(r) + parseInt(a) + 1 && 0 == parseInt(p) && 0 == parseInt(S) ? ($("#lblSendSMSValidation").show(), $("#lblSendSMSValidation").html("Please select the checkbox..."), e.preventDefault()) : "RETURNED" == i.text() && parseInt(n) == parseInt(r) + parseInt(a) + 1 && 0 == parseInt(p) && 0 == parseInt(S) ? ($("#lblSendSMSValidation").show(), $("#lblSendSMSValidation").html("Please select the checkbox..."), e.preventDefault()) : "CANCELLED" == i.text() && parseInt(n) == parseInt(a) + 1 && 0 == parseInt(p) && 0 == parseInt(S) ? ($("#lblSendSMSValidation").show(), $("#lblSendSMSValidation").html("Please select the checkbox..."), e.preventDefault()) : $("#lblOtpValidation").hide() : ($("#lblSendSMSValidation").show(), $("#lblSendSMSValidation").html("Please select the checkbox..."), e.preventDefault()) }), $("#CheckAll").click(function () { $("input[name='TaskToAssign']").attr("checked", this.checked) }), $("input[name='TaskToAssign']").click(function () { $("input[name='TaskToAssign']").length == $("input[name='TaskToAssign']:checked").length ? $("#CheckAll").attr("checked", "checked") : $("#CheckAll").removeAttr("checked") }), $("#btnAssign").click(function (t) { var n = $("input[name='TaskToAssign']:checked").length, s = $("#DeliverTo").children("option").filter(":selected").text(), l = $("#EmployeeList").val(), r = "", a = ""; if ($("input[name='TaskToAssign']:checked").each(function () { var e = ($(this).val(), $(this).val().split("|")); r += e[0] + ",", a = e[1] }), r = r.substring(0, r.length - 1), 0 == n) $("#lblAssign").html("No rows selected to assign").css("color", "red"), t.preventDefault(); else if ("Select" == s) $("#lblAssign").html("No 'DeliverTo' selected to assign").css("color", "red"), t.preventDefault(); else if ("" == l) $("#lblAssign").html("No 'EmployeeList' selected to assign").css("color", "red"), t.preventDefault(); else if ("IN_GODOWN" != a && "DISPATCHED_FROM_GODOWN" != a || "PICKUP" != s) { var i = "/EmployeeAssignment/Assign?EmployeeName=" + l + "&DeliverTo=" + s + "&ShopOrderCode=" + r; e(i) } else $("#lblAssign").html("One of the selected item(s) having 'IN_GODOWN/DISPATCHED_FROM_GODOWN' status. Please unselect that.").css("color", "red"), t.preventDefault() }), $("#btnUnAssign").click(function (t) { var n = $("input[name='TaskToAssign']:checked").length, s = "", l = ""; if ($("input[name='TaskToAssign']:checked").each(function () { var e = ($(this).val(), $(this).val().split("|")); s += e[0] + ",", l = e[2], "UNASSIGN" == l && t.preventDefault() }), s = s.substring(0, s.length - 1), 0 == n) $("#lblAssign").html("No rows selected to Unassign").css("color", "red"), t.preventDefault(); else if ("UNASSIGN" == l) $("#lblAssign").html("One of the selected item(s) having 'Unassign' status. Please unselect that.").css("color", "red"), t.preventDefault(); else { var r = "/EmployeeAssignment/UnAssign?EmployeeName=&ShopOrderCode=" + s; e(r) } }), $("#btnAssignClear").click(function () { $("#chkReturned").removeAttr("checked"), $("#CheckAll").removeAttr("checked"), $("input[name='TaskToAssign']").removeAttr("checked"), $("#DeliverTo option[value='']").attr("selected", "selected"), $("#EmployeeList option[value='']").attr("selected", "selected"), $("#lblAssign").html("") }), $("#btnSearchClear").click(function () { $("#DeliveryType option[value='']").attr("selected", "selected"), $("#DeliveryStatus option[value='']").attr("selected", "selected"), $("#EmployeeListSearch option[value='']").attr("selected", "selected"), $("#AssignStatus option[value='']").attr("selected", "selected"), $("#SearchString").val(""), $("#FromDate").val(""), $("#ToDate").val("") }) });