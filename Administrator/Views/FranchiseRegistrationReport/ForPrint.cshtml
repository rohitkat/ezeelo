
@model IEnumerable<ModelLayer.Models.ViewModel.FranchiseRegistrationReportViewModel>

@*<copyright file="GetReport.cshtml" company="NSP Futuretech Pvt. Ltd.">
     Copyright (c) NSP Futuretech Pvt. Ltd. All rights reserved.
    </copyright>
    <author>Harshada Raghorte</author>*@

@{
    ViewBag.Title = "Print";
    //Layout = null;
}

<style>
    .btn_Print {
        margin-bottom: 7px;
        margin-top: 7px;
        margin-left: 5px;
    }

    .section {
        position: relative;
        border: 1px solid #000;
        padding-top: 37px;
        margin-left: 5px; background: #A4A5A7;    
        width: 1010px;
        overflow-x: scroll;
    }

        .section.positioned {
            position: absolute;
            top: 100px;
            left: 100px;
            width: 800px;
            box-shadow: 0 0 15px #333;
        }

    .container_tbl {
        overflow-y:scroll;
        /*height: 200px;*/ height: 420px;
    }

    table {
        border-spacing: 0;
        width: 100%;
    }

    td + td {
        border-left: 1px solid #eee;
    }

    td, th {
        border-bottom: 1px solid #eee;
        background: #ddd;
        color: #000;
        padding: 10px 25px;
    }

    #myTable thead tr th {
        height: 0;
        line-height: 0 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
        color: transparent;
        border: none;
        white-space: nowrap;
    }

    th div {
        position: absolute;
        background: transparent;
        color: #fff;
        padding: 9px 10px;
        top: 0;
        margin-left: -8px;
        line-height: normal;
        /*border-left: 1px solid #800;*/ border-left: 1px solid #DDD;
    }

    th:first-child div {
        border: none;
    }
    #myTable {
        overflow-y: scroll;
    }
</style>



<div class="btn_Print">
    <input type="submit" id="btnPrint" value="Print" onclick="Print()" class="btn-primary" style="padding: 1px 10px;" />
</div>
<div class="section">
    <div class="table  scrollable container_tbl" id="divPrint" style="width:1535px;">
        <table class="table scroll" id="myTable">
            <thead>
                <tr class="header">

                    <th>
                        Franchise Name
                        <div>Franchise Name</div>
                    </th>
                    <th>
                        Owner Name
                        <div>Owner Name</div>
                    </th>
                    <th>
                        FranchiseRegistrationNo
                        <div>FranchiseRegistrationNo</div>
                    </th>
                    <th>
                        Mobile No
                        <div>Mobile No</div>
                    </th>
                    <th>
                        Email
                        <div>Email</div>
                    </th>
                    <th>
                        Address
                        <div>Address</div>
                    </th>
                    <th>
                        Landmark
                        <div>Landmark</div>
                    </th>
                    <th>
                        Pincode
                        <div>Pincode</div>
                    </th>
                    <th>
                        State
                        <div>State</div>
                    </th>
                    <th>
                        City
                        <div>City</div>
                    </th>
                    <th>
                        Contact Person
                        <div>Contact Person</div>
                    </th>
                    <th>
                        Contact Person Email
                        <div>Contact Person Email</div>
                    </th>
                    <th>
                        Registration Date
                        <div>Registration Date</div>
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.FranchiseName)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.OwnerName)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.FranchiseRegistrationNo)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.MobileNo)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Email)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Address)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Landmark)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Pincode)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.State)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.City)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.ContactPerson)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.ContactPersonEmail)
                        </td>
                        <td>
                            @{string lDate = "";}
                            @if (item.RegistrationDate != null)
                            {
                                lDate = item.RegistrationDate.ToString("dd/MM/yyyy");
                            }
                            @lDate
                        </td>
                        <td>
                            @*@Html.ActionLink("Edit", "Edit", new { id=item.ID }) |
                                @Html.ActionLink("Details", "Details", new { id=item.ID }) |
                                @Html.ActionLink("Delete", "Delete", new { id=item.ID })*@
                        </td>
                    </tr>
                }
            </tbody>


        </table>
    </div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">
    function Print() {
        var divContents = $("#divPrint").html();
        var printWindow = window.open('', '', 'height=400,width=800');
        printWindow.document.write('<html><head><title>Franchise Registration Report</title>');
        printWindow.document.write('</head><body >');
        printWindow.document.write(divContents);
        printWindow.document.write('</body></html>');
        printWindow.document.close();
        printWindow.print();
    }
</script>


